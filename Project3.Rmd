---
title: "Project3"
author: "Ruben Sowah"
date: "2022-10-30"
output: 
  github_document :
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,message  = F, warning = F, cache = T)
```


```{r, echo = F, eval = F}
rmarkdown::render("project3.Rmd",
                  output_format = "github_document",
                  output_file = "README.md",
                  output_options = list(
                  html_preview = FALSE, toc = TRUE, toc_depth = 2, toc_float = TRUE))
```
# Introduction

The dataset that we used is called Online News Popularity Data set. This dataset concluded multiple features of articles published by Mashable in past years. Our goal is to use different predictive models to predict the number of shares in social networks. Our target variable is the number of shares. The variable name of our target variable is called shares. Thus, shares will be our dependent variable in our predictive models. After our discussion, we both think the rate of unique words in the content, the number of links, the number of images, the number of videos, whether the article was published on the weekend, the rate of positive words in the content, the rate of negative words in the content, the average polarity of positive words, the average polarity of negative words, whether the article published on a Saturday will affect the number of shares for article. Thus, we selected ** n_tokens_content, num_hrefs, num_imgs, num_videos, is_weekend, global_rate_positive_words, global_rate_negative_words, avg_positive_polarity, avg_negative_polarity, weekday_is_saturday ** as our independent variables.

This dataset has six different channels, which are a lifestyle channel, an entertainment channel, a bus channel, a social media channel, a tech channel, and a world channel. We will subset the dataset based on different channel types before we create our predictive models. 

We will fit a random forest model and fit a boosted tree model. Both models will be chosen using cross-validation. We will describe those in more detail later.

# Load packages
```{r}
library(tidyverse)
library(caret)
library(Metrics)
library(ggplot2)
library(readr)
library(corrplot)
library(knitr)

```

# Read in the data

```{r}
## Read and get an overview of the data
data <- read_csv("OnlineNewsPopularity.csv")
head(data)

## Subset the data by the entertainment channel, and select our desired features
data <- data %>% 
        filter(data_channel_is_entertainment == 1) %>%
        select(n_tokens_content,num_hrefs,num_imgs, num_videos,weekday_is_saturday,is_weekend,global_rate_positive_words,global_rate_negative_words,avg_positive_polarity,avg_negative_polarity,shares) 

## Coerce the categorical variables into factor
data$weekday_is_saturday <- as.factor(data$weekday_is_saturday)
data$is_weekend <- as.factor(data$is_weekend)


print(data, width = 100, n = 10)
levels(data$weekday_is_saturday)       
```

# Summarizations
```{r}
# Create contingency table of whether the article was published on the weekend
table(data$is_weekend)
```
***Comments:***
Based on the contingency table, we can see how many articles are published on weekend.
0 means articles are not published on weekend. 1 means articles are published on weekend.

```{r}
# Create contingency table of whether the article was published on the Saturday
table(data$weekday_is_saturday)
```

***Comments:***
Based on the contingency table, we can see how many articles are published on Saturday.
0 means articles are not published on Saturday. 1 means articles are published on Saturday.

```{r}
# Create bar plot to see whether the article was published on the Saturday

ggplot(data, aes(x=weekday_is_saturday))+
  geom_bar(aes(fill = "drv")) + 
  labs(y="Number of the Articles Were Published on the Saturday", 
       title= "Weekend published article's Bar plot")
```
***Comments:***
Based on the bar plot, we can see how many articles are published on Saturday.



```{r}
# Create histogram to see number of shares and whether the article was published on the Weekend

ggplot(data = data, aes(x = shares))+ 
  geom_histogram(bins = 20, aes(fill = is_weekend)) +
  labs(x = "Number of Shares",
       y="Number of the Articles Were Published on the Weekend", 
       title = "Histogram of Shares that are Related to Weekend") +
       scale_fill_discrete(name = "Whether Weekend Published", 
                           labels = c("No", "Yes"))

```

***Comments:***
Based on this histogram, we can see the distribution of the number of shares. 
If the peak of the graph lies to the left side of the center, it means that 
most of articles have small number of shares. 
If the peak of the graph lies to the right side of the center, it means that most of articles have large number of shares. 
If we see a bell shape, it means that the number of articles have large number of shares is similar with 
the number of articles have small number of shares. 
The No means the articles were published on weekend. The Yes means
the articles were published on weekend.


